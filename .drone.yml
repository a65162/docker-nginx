kind: pipeline
type: docker
name: default

steps:
  - name: 使用 cloud.drone.io 部署 Nginx 到私人伺服器
    image: appleboy/drone-ssh
    settings:
      host: 
        from_secret: ssh_host
      environment:
        - DEBUG=true
      username: 
        from_secret: ssh_username
      password: 
        from_secret: ssh_password
      port: 22
      environment:
        DEFAULT_EMAIL1: test
        DEFAULT_EMAIL:
          from_secret: DEFAULT_EMAIL
      envs:
        - DEFAULT_EMAIL
        - DEFAULT_EMAIL1
      script:
        - rm -rf docker-nginx
        - git clone git@github.com:a65162/docker-nginx.git
        - cd docker-nginx
        - docker-compose down
        - export DEFAULT_EMAIL=$DEFAULT_EMAIL
        - echo $DEFAULT_EMAIL
        - echo ${DEFAULT_EMAIL}
        - echo $${DEFAULT_EMAIL}
        - echo $DEFAULT_EMAIL1
        - echo ${DEFAULT_EMAIL1}
        - echo $${DEFAULT_EMAIL1}
        - docker-compose up -d